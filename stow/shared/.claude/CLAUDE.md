# Claude instructions

## Self review

After implementing something, always look back and critically review what you
did with the following in mind:

- Explicitness/simplicity over implicitness/cleverness
- Concistent and systematic approach instead of fragemented and ad-hoc solutions
- YAGNI
- Great DX and UX
- Ease of long-term maintenance
- Follow conventions by the language, ecosystem, open source community
- Brittle or potentially buggy code

If you discover apparent improvement areas, go back and refactor. When unsure,
ask questions.

## AIP

When working with backends, adhere to
[Google's AIP](https://google.aip.dev/general). Look up rules when in doubt. Use
the "aip" skill.

## Sage

If there's a `.sage/` folder in the project, this indicates the project uses
Makefiles to run commands for linting, testing, deploying etc. These Makefiles
are generated by the Go code inside the `./sage` folder.
[Sage](https://github.com/einride/sage) is an open source project.

## Pocket

If there's a `.pocket/` folder in the project, this indicates the project uses
`./pok` shims to run commands for linting, testing, deploying etc. These shims
are generated by [Pocket](https://github.com/fredrikaverpil/pocket) (an open
source project). Use `./pok -h` to list the tasks available.

## Testing

Prefer the AAA pattern (Arrange, Act, Assert). When asserting, always assert on
whole objects. Use e.g. got/want pattern in Go using
[gotest.tools](https://pkg.go.dev/gotest.tools/v3/assert) in Go.

## Git

Use the "git-commit" skill.

## GCP

If you see `console.cloud.google.com` links, use the `gcloud` command to access
the related details.

## GitHub

When I provide github.com links (PRs, issues, comments, actions, etc.), ALWAYS
use the `gh` CLI to fetch the content instead of WebFetch. WebFetch often fails
on GitHub pages.

Use the "gh-cli" skill for `gh` commands and "gh-pr" skill for creating PRs.

## Jira

If you come by a Jira ticket number or Jira URL, use `jira`
([jira-cli](https://github.com/ankitpokhrel/jira-cli)) to acquire more details
for increased understanding of the problem at hand.

Use the "jira-cli" skill.

## Go

- Use the `gopls` LSP at all times when searching for references to symbols,
  renaming packages/variables/functions etc.
- If a package is not installed locally, search
  [https://pkg.go.dev](pkg.go.dev). Standard library functions are available
  (example: [`https://pkg.go.dev/fmt`](fmt package)).
- You can run `go mod tidy` recursively in the repo with the custom
  [`go-mod-tidy`](shell/bin/go-mod-tidy) shell script.

Use the "golang-style" skill.

## Npm and bun

- Always prefer `bun` (or `bunx`) over `npm` (or `npmx`), unless the project
  explicitly already uses Node/npm.

## Python

- Always use `uv` to run Python commands.
- Prefer `uv` with `pyproject.toml` to define dependencies.
