# Claude instructions

## Self review

After implementing something, always look back and critically review what you
did with the following in mind:

- Simplicity and consistency over cleverness
- Explicitness over implicitness
- Great DX and UX
- Ease of long-term maintenance
- Follow conventions by the language, ecosystem, open source community
  conventions

If you discover apparent improvement areas, go back and refactor. When unsure,
ask questions.

## AIP

When working with backends, adhere to
[Google's AIP](https://google.aip.dev/general). Look up rules when in doubt.

## Sage

If there's a `.sage/` folder in the project, this indicates the project uses
Makefiles to run commands for linting, testing, deploying etc. These Makefiles
are generated by the Go code inside the `./sage` folder.
[Sage](https://github.com/einride/sage) is an open source project.

## Pocket

If there's a `.pocket/` folder in the project, this indicates the project uses
`./pok` shims to run commands for linting, testing, deploying etc. These shims
are generated by [Pocket][https://github.com/fredrikaverpil/pocket] (an open
source project). Use `./pok -h` to list the tasks available.

## Git

When creating git commits, do NOT include "Co-Authored-By" or any other
attribution to Claude/AI in the commit message. Always use conventional commits
(with scope, when possible).

## GCP

If you see `console.cloud.google.com` links, use the `gcloud` command to access
the related details.

## GitHub

When I provide github.com links (PRs, issues, comments, actions, etc.), ALWAYS
use the `gh` CLI to fetch the content instead of WebFetch. WebFetch often fails
on GitHub pages. Useful commands:

- `gh api repos/OWNER/REPO/pulls/NUMBER/comments` - PR review comments
- `gh api repos/OWNER/REPO/pulls/NUMBER/reviews` - PR reviews
- `gh pr view NUMBER` - PR details
- `gh run view RUN_ID --log` - GitHub Actions logs

### Pull requests body

When submitting a pull request, follow my style of describing what I did by
creating three headers; "## Why?" (this change), "## What?" (was changed) and
"## Notes" (detailing additional references, gotchas, alternative solutions
etc). Try to be concise and use bullet points and, when needed, consice examples
in code blocks. Never attribute Claude or LLMs.

## Jira

If you come by a Jira ticket number, use `jira`
([jira-cli](https://github.com/ankitpokhrel/jira-cli)) to acquire more details
for increased understanding of the problem at hand.

## Go

- Use the `gopls` LSP at all times when searching for references to symbols,
  renaming packages/variables/functions etc.
- Use `go doc` when uncertain on how to use a package.
- If the package is not installed locally, search
  [https://pkg.go.dev](pkg.go.dev). Standard library functions are available
  (example: [`https://pkg.go.dev/fmt`](fmt package)).
- You can run `go mod tidy` recursively in the repo with the custom
  [`go-mod-tidy`](shell/bin/go-mod-tidy) shell script.

## Npm and bun

- Always prefer `bun` (or `bunx`) over `npm` (or `npmx`), unless the project
  explicitly already uses Node/npm.

## Python

- Always use `uv` to run Python commands.
- Prefer `uv` with `pyproject.toml` to define dependencies.
